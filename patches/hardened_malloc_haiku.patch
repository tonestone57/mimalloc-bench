diff --git a/memory.c b/memory.c
index 2d995ef..42dff4e 100644
--- a/memory.c
+++ b/memory.c
@@ -1,7 +1,9 @@
 #include <errno.h>

 #include <sys/mman.h>
+#ifndef __HAIKU__
 #include <sys/prctl.h>
+#endif

 #ifndef PR_SET_VMA
 #define PR_SET_VMA 0x53564d41
@@ -95,7 +97,7 @@ bool memory_purge(void *ptr, size_t size) {
 }

 bool memory_set_name(UNUSED void *ptr, UNUSED size_t size, UNUSED const char *name) {
-#ifdef LABEL_MEMORY
+#if defined(LABEL_MEMORY) && !defined(__HAIKU__)
     return prctl(PR_SET_VMA, PR_SET_VMA_ANON_NAME, ptr, size, name);
 #else
     return false;
diff --git a/random.c b/random.c
index 8883531..abda53e 100644
--- a/random.c
+++ b/random.c
@@ -1,13 +1,20 @@
 #include <errno.h>
 #include <string.h>

+#ifdef __HAIKU__
+#include <stdlib.h>
+#else
+#include <sys/random.h>
+#endif
+
 #include "chacha.h"
 #include "random.h"
 #include "util.h"

-#include <sys/random.h>
-
 static void get_random_seed(void *buf, size_t size) {
+#ifdef __HAIKU__
+    arc4random_buf(buf, size);
+#else
     while (size) {
         ssize_t r;

@@ -22,6 +29,7 @@ static void get_random_seed(void *buf, size_t size) {
         buf = (char *)buf + r;
         size -= r;
     }
+#endif
 }

 void random_state_init(struct random_state *state) {
