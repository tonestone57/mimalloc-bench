--- src/tests/proc_maps_iterator_test.cc
+++ src/tests/proc_maps_iterator_test.cc
@@ -39,7 +39,7 @@
 #include "base/generic_writer.h"
 #include "gtest/gtest.h"

-#if defined __ELF__
+#if defined __ELF__ && !defined __HAIKU__
 #include <link.h>
 #define PRINT_DL_PHDRS
 #endif
@@ -68,6 +68,16 @@ TEST(ProcMapsIteratorTest, ForEachMapping) {

 #ifdef PRINT_DL_PHDRS

+#ifndef PF_R
+#define PF_R 0x4
+#endif
+#ifndef PF_W
+#define PF_W 0x2
+#endif
+#ifndef PF_X
+#define PF_X 0x1
+#endif
+
 std::string MapFlags(uintptr_t flags) {
   std::string ret;
   ret += (flags & PF_R) ? "r" : "-";
